{{ define "header" }}
<header class="mdl-layout__header mdl-layout__header--waterfall mdl-shadow--2dp {{ .Site.Params.styles.header_color }} {{ .Site.Params.styles.header_color_text }}">
	<div class="mdl-layout__header-row">
		<span class="mdl-layout-title">{{ .Site.Title }}</span>
		<div class="mdl-layout-spacer"></div>
		<button id="resume-more-all" class="resume-more mdl-button mdl-js-button mdl-button--icon" onclick="moreAllHandler(event)">
			<i class="material-icons {{ .Site.Params.styles.header_color_text }}" role="presentation">expand_more</i>
			<span for="resume-more-all" class="mdl-tooltip">Show Details</span>
		</button>
		<a href="/resume/print/" id="resume-print" class="mdl-button mdl-js-button mdl-button--icon">
			<i class="material-icons {{ .Site.Params.styles.header_color_text }}" role="presentation">print</i>
			<span for="resume-print" class="mdl-tooltip">Print</span>
		</a>
		<a href="/resume/text/" download="{{ .Site.Title | urlize }}.txt" id="resume-download" class="mdl-button mdl-js-button mdl-button--icon">
			<i class="material-icons {{ .Site.Params.styles.header_color_text }}" role="presentation">file_download</i>
			<span for="resume-download" class="mdl-tooltip">Download Text File</span>
		</a>
	</div>
	<div class="mdl-layout__tab-bar mdl-js-ripple-effect {{ .Site.Params.styles.header_color }}">
		{{ range $orgTypeKey, $orgTypeValue := .Site.Params.org_types }}
		<a href="#scroll-tab-{{ $orgTypeKey }}" class="mdl-layout__tab {{ $.Site.Params.styles.header_color_text }} {{ if eq $orgTypeKey "10" }} is-active{{ end }}">{{ $orgTypeValue }}</a>
		{{ end }}
	</div>
</header>
{{ end }}

{{ define "main" }}
{{ $orgs := .Site.Data.orgs }}
{{ $positions := sort .Site.Data.positions "end_date" "desc" }}

{{/* Sorts the orgs in descending order based on the most recent position end date. */}}
{{ range sort $positions "end_date" }}
	{{ $.Scratch.SetInMap "orgMap" .org (dict "id" .org "end_date" .end_date) }}
{{ end }}
{{ $sortedOrgs := sort ($.Scratch.GetSortedMapValues "orgMap") "end_date" "desc" }}
{{ range $orgTypeKey, $orgTypeValue := .Site.Params.org_types }}
<section class="mdl-layout__tab-panel{{ if eq $orgTypeKey "10" }} is-active{{ end }}" id="scroll-tab-{{ $orgTypeKey }}">
	{{ range $sortedOrgs }}
	{{ $orgKey := .id }}
	{{ $org := index $orgs $orgKey }}
	{{ if eq $org.org_type $orgTypeKey }}
	<section class="resume-org mdl-grid mdl-grid--no-spacing mdl-shadow--2dp">
		<div class="mdl-card mdl-cell mdl-cell--12-col">
			<div class="mdl-card__supporting-text mdl-grid mdl-grid--no-spacing">
				<div class="resume-title">
					<div class="mdl-typography--headline">{{ $org.name }}</div>
					<div class="resume-location mdl-typography--subhead">{{ $org.location }}</div>
				</div>
				{{ range $positions }}
				{{ if eq .org $orgKey }}
				<div class="resume-position mdl-cell mdl-cell--12-col">
					<div class="resume-title">
						<div class="mdl-typography--subhead">{{ .title }}</div>
						<div>
							<div class="mdl-typography--body-1">{{ partial "dates" . }}</div>
						</div>
					</div>
					{{ with .overview }}<span class="mdl-typography--body-1">{{ . }}</span>{{ end }}
					{{ with .accomplishments }}
					<button class="resume-more mdl-button mdl-js-button mdl-button--icon" onclick="moreHandler(event)">
						<i class="material-icons mdl-color-text--accent" role="presentation">expand_more</i>
					</button>
					<ul>
						{{ range . }}
						<li class="resume-hidden">{{ . }}</li>
						{{ end }}
					</ul>
					{{ end }}
				</div>
				{{ end }}
				{{ end }}
			</div>
		</div>
	</section>
	{{ end }}
	{{ end }}
</section>
{{ end }}
{{ end }}

{{ define "footer" }}
<script src="/js/resume-transpiled.js"></script>
{{ end }}
